Монада - цепочка методов, которая не сломается, не взорвётся ошибкой.
"Нечаянно" задействуется типозащищённость.


---

Чтобы писать в VBA **функциональный и масштабируемый код**, нужно перейти от императивных привычек к новым принципам.

Пример цепочки:
```vb
Dim res As clsResult
Set res = ResultOk(5) _
    .Bind("MyFunc1") _
    .Bind("MyFunc2")

If res.IsSuccess Then
    Debug.Print res.value
Else
    Debug.Print res.Error
End If
```

Цепочку легко расширять:
```vb
Set res = ResultOk(5) _
    .Bind("MyFunc3") _
    .Bind("MyFunc1") _
    .Bind("MyFunc4") _
    .Bind("MyFunc2")
```

**Ключевые принципы:**
1. Функция, которая может завершиться ошибкой, **возвращает `clsResult`**, а не значение напрямую.
2. Ошибка — **нормальное состояние**, а не исключение.
3. Обработка ошибок **локализована внутри функции**, а не размазана по вызывающему коду.
4. На старте кода больше, но при росте функционала он **растёт медленнее**, остаётся **читаемым и изменяемым**.
5. Цепочка **не падает** — ошибка просто передаётся до конца.
6. Побочные эффекты (лог, метрики и т.п.) **централизованы** в `clsResult`, а не разбросаны по функциям.
7. Объекты `clsResult` создаются **только через фабрики** — `ResultOk` и `ResultErr`.

Пример надёжной функции:
```vb
Public Function MyFunc2(value As Variant) As clsResult
    If Not IsNumeric(value) Then
        Set MyFunc2 = ResultErr("MyFunc2: ожидается число")
        Exit Function
    End If
    Set MyFunc2 = ResultOk("Result: " & CStr(CDbl(value)))
End Function
```

**Как это работает в VBA?**  
VBA — императивный язык. Он не знает о функциональном программировании и просто вызывает методы слева направо:
```vba
Set temp1 = ResultOk(5)
Set temp2 = temp1.Bind("MyFunc1")
Set temp3 = temp2.Bind("MyFunc2")
Set res = temp3
```

Если на любом шаге возникает ошибка, последующие вызовы **пропускаются**, потому что `Bind` в состоянии ошибки возвращает `Me` без выполнения функции. Это и есть **монадическое поведение**: явное, предсказуемое, без исключений.

Результат — **линейный код с ветвлением по ошибкам**, где каждая функция отвечает только за свою логику, а не за обработку чужих сбоев.

Это не «хаскель в VBA» — это **инженерное решение** для повышения надёжности в среде, где исключения легко теряются, а `On Error Resume Next` портит логику.
